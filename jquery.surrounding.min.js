(function(e){e.fn.surround=function(t){var n=e(this).find("img:first").hide();var r=e(this);if(!t){t=new Object;t.source=n.attr("src")}e(this).css({background:"url("+t.source+")","background-size":"auto 100%",cursor:"pointer"});e(this).mousewheel(function(t,n){var r=parseInt(e(this).css("background-position-x"));e(this).css("background-position-x",r+n*30+"px");t.preventDefault()});e(this).on("dblclick",function(){if(!r.hasClass("fullscreen")){r.clone().appendTo("body").addClass("fullscreen").css({position:"absolute",top:0,left:0,margin:0}).animate({width:"100%",height:"100%"},500,function(){jQuery(this).surround()})}else{r.animate({opacity:0},500,function(){r.remove()})}});var i=0;e(this).bind("touchstart mousedown",function(t){t.preventDefault();if(t.type=="touchstart"){var n=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];i=n.pageX;var r=(new Date).getTime();var s=e(this).data("lastTouch")||r+1;var o=r-s;if(o<500&&o>0){e(this).data("lastTouch",null);e(this).trigger("dblclick")}else{e(this).data("lastTouch",r)}}else{i=t.pageX}e(this).css({cursor:"w-resize"})});e(this).bind("touchmove mousemove",function(t){t.preventDefault();if(i!=0){var n;if(t.type=="touchmove"){var r=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];n=i-r.pageX;i=r.pageX}else{n=i-t.pageX;i=t.pageX}var s=parseInt(e(this).css("background-position-x"));e(this).css("background-position-x",s-n+"px")}});e(this).bind("touchend mouseup mouseleave",function(t){t.preventDefault();i=0;e(this).css({cursor:"pointer"})})}})(jQuery)